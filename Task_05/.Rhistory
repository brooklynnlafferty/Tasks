install.packages("swirl")
library(swirl)
library(swirl)
#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
library (swirl)
swirl()
5+7
x<- 5+7
x
y<- x-3
y
z<- c(1.1,9,3.14)
?c
z
c(z,555,z)
z*2+100
my_sqrt<- sqrt(z-1)
my_sqrt
my_div<- z/my_sqrt
my_div
c(1,2,3,4)+c(0,10)
c(1,2,3,4)+c(0,10,100)
z*2+1000
my_div
setwd('/Users/mitchell/Desktop/Evolution/Tasks/Tasks_02')
setwd('This PC> Task_02')
5
A<- 5
A*2
B<- c(A,5,5)
B
B*2
B<- c(A,5,5)
B*2
C<- c(B,6,10)
C*6
D<- c(1,5,10,15,20)
sum(D)
mean(D)
min(D)
E<- c(6,7,8,9,10)
which(E==8)
which(E>8)
E[which(E>8)]
trueMean1<- 5
trueSD1<- 5
population1<- rnorm(1e6, trueMean1, trueSD1)
trueMean2<- 4
trueSD2<- 5
population2< rnorm(1e6, trueMean2, trueSD2)
population2<-rnorm(1e6, trueMean2, trueSD2)
source("~/task03.r")
Size<- 50
Sample1<- sample(population1, Size)
Sample2<- sample(population2, Size)
boxplot(Sample1, Sample2)
individual1<- c("B","A")
individual2<- c("A","A")
Gam1<- sample(individual1,1)
Gam2<- sample(individual2,1)
newBaby<- c(Gam1,Gam2)
isHet<-c()
for(i in 1:100)
Gam1<- sample(individual1,1)
for(i in 1:100){}
Gam1<- sample(individual1,1)
Gam2<- sample(individual2,1)
newBaby<- c(Gam1,Gam2)
isHet[i]<- Gam1==Gam2
sum(isHet)/length(isHet)
isHet<-c()
for(i in 1:100){
Gam1<- sample(individual1,1)
Gam2<- sample(individual2,1)
newBaby<- c(Gam1,Gam2)
isHet[i]<- Gam1==Gam2}
sum(isHet)/length(isHet)
source("http://jonsmitchell.com/code/simFxn04.R")
MatGrandma<- makeFounder("grandma_mom")
MatGrandpa<- makeFounder("grandpa_mom")
PatGrandma <- makeFounder("grandma_da")
PatGrandpa<- makeFounder("grandpa_da")
head(MatGrandma)
head(MatGrandpa)
head(PatGrandma)
head(PatGrandpa)
Alan<- makeBaby(PatGrandma, PatGrandpa)
Focus<- makeBaby(Brenda,Alan)
Brenda<- makeBaby(MatGrandma,MatGrandpa)
Focus<- makeBaby(Brenda,Alan)
source("~/task03.r")
head(Focus)
source("~/task03.r")
ToMom<- length( grep("mom",Focus))/length(Focus)
ToMomMom<- length<- (grep("grandma_mom",Focus))/length(Focus)
ToMomMom<- length(grep("grandma_mom",Focus))/length(Focus)
ToMomDad<- length(grep("granpa_mom",Focus))/length(Focus)
head(ToMomMom)
head(ToMomDad)
Sibling_01<- makeBaby(Brenda,Alan)
ToSib<- length(intersect(Focus, Sibling_01))/length(Focus)
ManySiblings<- replicate (le3,length(intersect(Focus,makeBaby(Brenda,Alan)))/length(Focus))
ManySiblings<- replicate (1e3,length(intersect(Focus,makeBaby(Brenda,Alan)))/length(Focus))
quantile(ManySiblings)
mean(ManySiblings)
source("~/task03.r")
source("~/task03.r")
source("~/task03.r")
source("~/task03.r")
source("~/task03.r")
source("~/task03.r")
cor.test(Focus,ManySiblings)
head(ManySiblings)
source("~/task03.r")
boxplot(Focus,ManySiblings)
boxplot(Focus,ManySiblings)
bxoplot(Focus:ManySiblings)
boxplot(Focus:ManySiblings)
boxplot(Focus,ManySiblings)
boxplot(Focus:,ManySiblings:)
boxplot(Focus,ManySiblings:)
boxplot("Focus","ManySiblings")
boxplot(Focus,ManySiblings)
boxplot(ManySiblings)
source("~/task03.r", echo=TRUE)
hist(ManySiblings)
source("~/task03.r")
source("~/task03.r")
hist(ManySiblings)
boxplot(ManySiblings)
hist(ManySiblings)
head(ManySiblings)
pdf("003_relatePlot.pdf")
pdf("003_relatePlot.pdf")
hist(ManySiblings)
boxplot(ManySiblings)
pdf("003_relatePlot.pdf")
hist(ManySiblings)
head(ManySiblings)
source("~/task03.r")
hist(ManySiblings)
source("~/task03.r")
hist(ManySiblings)
pdf("003_relatePlot")
hist(ManySiblings)
source("~/task03.r")
source("~/task03.r")
source("~/task03.r")
source("~/task03.r")
source("~/task03.r")
hist(ManySiblings)
source("~/task03.r")
setwd('~/Desktop/Evolution/Tasks/Task_05')
install.packages("adegenet")
install.packages("poppr")
install.packages("dplyr")
install.packages("hierfstat")
install.packages("reshape2")
install.packages("ggplot2")
install.packages("RColorBrewer")
install.packages("scales")
library(adegenet)
library(poppr)
library(dplyr)
library(hierfstat)
library(reshape2)
library(ggplot2)
library(RColorBrewer)
library(scales)
lobster<- read.csv ("https://jonsmitchell.com/data/lobster_genotypes.csv")
lobster_wide<- reshape(lobster, idvar=c("ID","Site"), timevar="Locus", direction="wide",sep="")
colnames(lobster_wide)<- gsub("Genotype","",colnames(lobster_wide))
snpgeno<- lobster_wide[, 3:ncol(lobster_wide)]
snps_to_remove<- c("25580","32362","41521","53889","65376","8953","21197","15531","22740","28357","33066","51507","53052","53263","21880","22323","22365")
snpgeno<- snpgeno[,!colnames(snpgeno)%in% snps_to_remove]
ind<- as.character(lobster_wide$ID)
site<- as.character(lobster_wide$Site)
lobster_gen<- df2genind(snpgeno, ploidy=2, ind.names=ind,pop=site,sep="")
lobster_gen<- missingno(lobster_gen, type="geno",cutoff=0.20)
mlg(lobster_gen)
dups_lobster<- mlg.id(lobster_gen)
lob_dups<- c()
x<-1
for(i in dups_lobster){
if(length(dups_lobster[i])>1){
lob_dups[x]<-i
x<- x+1
}
}
lob_Nodups<- indNames (lobster_gen)[!indNames(lobster_gen) %in% lob_dups]
lobster_gen<- lobster_gen[lob_Nodups, ]
summary(lobster_gen$pop)
basic_lobster<- basic.stats(lobster_gen, diploid=TRUE)
Ho_lobster<- round(apply(basic_lobster$Ho, MARGIN=2, FUN=mean, na.rm=TRUE),digits=3)
He_lobster<- round(apply(basic_lobster$Hs, MARGIN=2,FUN=mean, na.rm=TRUE),digits=3)
pdf("005_plot01.pdf")
par(mar=c(4,4,1,1), las=1, mgp=c(2,0.25,0),tck=-0.005,cex.lab=1.25)
plot(He_lobster,Ho_lobster, xlab="expected H",ylab="observed H", pch=21,bg="gray",xlim=c(0.32,0.405),ylim=c(0.32,0.405))
abline(0,1,lty=3)
abline(lm(Ho_lobster~He_lobster), lty=2,lwd=1.25,col='red')
dev.off()
Fis<- apply(basic_lobster$Fis, MARGIN=2, FUN=mean, na.rm=TRUE)
lobster_gen_sub<- popsub(lobster_gen, sublist=c("Ale","Ber","Brd","Pad","Sar17","Vig"))
lobster_fst<- genet.dist(lobster_gen_sub, method="WC84") %>% round(digits=3)
lab_order<- c("Ber","Brd","Pad","Vig","Sar17","Ale")
fst.mat<- as.matrix(lobster_fst)
fst.mat1<- fst.mat[lab_order,]
fst.mat2<- fst.mat1[,lab_order]
ind<- which(upper.tri(fst.mat2),arr.ind=TRUE)
fst.df<- data.frame(Site1=dimnames(fst.mat2)[[2]][ind[,2]],Site2=dimnames(fst.mat2)[[1]][ind[,1]],Fst=fst.mat2[ ind ])
fst.df$Site1<- factor(fst.df$Site1,levels=unique(fst.df$Site1))
fst.df$Site2<- factor(fst.df$Site2,levels=unique(fst.df$Site2))
fst.df$Fst[fst.df$Fst<0]<- 0
fst.label<- expression(italic("F")[ST])
mid<- max(fst.df$Fst)/2
pdf("005_plot02.pdf")
ggplot(data=fst.df,aes(x=Site1,y=Site2,fill=Fst))+geom_tile(colour="black")+geom_text(aes(label=Fst),color="black",size=3)+scale_fill_gradient2(low="blue",mid="pink",high="red",midpoint=mid,name=fst.label,limits=c(0,max(fst.df$Fst)),breaks=c(0,0.05,0.10,0.15))+scale_x_discrete(expand=c(0,0))+scale_y_discrete(expand=c(0,0),position="right")+theme(axis.text=element_text(colour="black",size=10,face="bold"),axis.title=element_blank(),panel.grid=element_blank(),panel.background=element_blank(),legend.position="right",legend.title=element_text(size=14,face="bold"),legend.text=element_text(size=10))
dev.off()
